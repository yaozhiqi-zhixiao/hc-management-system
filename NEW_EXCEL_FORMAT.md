# 📊 HC管理系统 - 新Excel格式支持

## 🎉 系统已更新！

我已经修改了HC管理系统，现在支持你的复杂Excel格式！

## 📋 支持的Excel列名格式

### 部门层级列（必需）
- **一级部门** - 顶级部门
- **二级部门** - 二级部门
- **三级部门** - 三级部门
- **四级部门** - 四级部门
- **五级部门** - 五级部门
- **六级部门** - 六级部门

### 员工信息列（可选）
- **员工类型** - 员工分类
- **job family** - 职位族群
- **job group** - 职位组
- **职级** - 员工职级
- **城市** - 工作城市

### 月度HC数据列（必需）
- **1月** - 1月HC数量
- **2月** - 2月HC数量
- **3月** - 3月HC数量
- **4月** - 4月HC数量
- **5月** - 5月HC数量
- **6月** - 6月HC数量
- **7月** - 7月HC数量
- **8月** - 8月HC数量
- **9月** - 9月HC数量
- **10月** - 10月HC数量
- **11月** - 11月HC数量
- **12月** - 12月HC数量

## 📝 Excel文件示例格式

| 一级部门 | 二级部门 | 三级部门 | 四级部门 | 五级部门 | 六级部门 | 员工类型 | job family | job group | 职级 | 城市 | 1月 | 2月 | 3月 | 4月 | 5月 | 6月 | 7月 | 8月 | 9月 | 10月 | 11月 | 12月 |
|---------|---------|---------|---------|---------|---------|---------|-----------|-----------|------|------|-----|-----|-----|-----|-----|-----|-----|-----|-----|------|------|------|
| 技术中心 | 研发部 | 前端组 | | | | 正式员工 | Engineering | Frontend | P6 | 北京 | 5 | 5 | 6 | 6 | 7 | 7 | 8 | 8 | 8 | 9 | 9 | 10 |
| 技术中心 | 研发部 | 后端组 | | | | 正式员工 | Engineering | Backend | P7 | 上海 | 8 | 8 | 9 | 9 | 10 | 10 | 11 | 11 | 12 | 12 | 13 | 13 |
| 产品中心 | 产品部 | 用户体验 | | | | 正式员工 | Product | UX | P5 | 深圳 | 3 | 3 | 4 | 4 | 4 | 5 | 5 | 6 | 6 | 6 | 7 | 7 |

## 🔧 系统处理逻辑

### 1. 部门层级处理
- 系统会自动组合所有非空的部门级别
- 格式：`一级部门 > 二级部门 > 三级部门...`
- 示例：`技术中心 > 研发部 > 前端组`

### 2. 员工信息处理
- 将员工类型、job family、job group、职级、城市组合
- 格式：`员工类型 | job family | job group | 职级 | 城市`
- 示例：`正式员工 | Engineering | Frontend | P6 | 北京`

### 3. 月度数据处理
- 自动处理12个月的HC数据
- 只处理大于0的数值
- 月份格式：`2025-01`, `2025-02`...`2025-12`

### 4. 数据展示
- **部门统计**：按完整部门路径统计
- **月度趋势**：显示12个月的HC变化
- **热力图**：部门×月份的HC分布

## 🚀 使用步骤

1. **准备Excel文件**
   - 确保包含上述列名
   - 第一行必须是表头
   - HC数据填入对应月份列

2. **重启服务器**
   - 停止当前服务器（Ctrl+C）
   - 重新运行：`npm run dev`

3. **上传测试**
   - 访问：http://localhost:3000
   - 上传你的Excel文件
   - 查看解析结果

## 📊 预期结果

上传成功后你会看到：
- ✅ 成功处理消息
- 📊 多级部门统计图表
- 📈 12个月的HC趋势
- 🔥 部门×月份热力图
- 📋 详细的HC数据表格

## ⚠️ 注意事项

1. **列名必须完全匹配**（区分大小写）
2. **HC数据必须是数字**
3. **空值会被忽略**
4. **至少需要一个部门级别**
5. **至少需要一个月份有数据**

---

**现在你可以直接上传你的Excel文件了！系统已经完全支持你的格式！** 🎉
